<!DOCTYPE html><html lang="zh"><head><meta charset="utf-8"><title>WFST加权有限状态转换机-下 | Nighttellの小世界</title><meta name="author" content="Nighttell"><meta name="description" content="一个小菜鸡的博客"><meta name="keywords" content=""><meta name="viewport" content="width=device-width,initial-scale=1,maximum-scale=1,user-scalable=0"><link rel="icon" href="https://nighttellpic.netlify.app/head.jpg"><script src="https://cdn.staticfile.org/vue/3.3.4/vue.global.prod.min.js"></script><link rel="stylesheet" href="https://cdn.staticfile.org/font-awesome/6.4.0/css/all.min.css"><link rel="stylesheet" href="/css/fonts.min.css"><script>const mixins={}</script><script src="https://polyfill.io/v3/polyfill.min.js?features=default"></script><script src="https://cdn.staticfile.org/highlight.js/11.8.0/highlight.min.js"></script><script src="https://cdn.staticfile.org/highlightjs-line-numbers.js/2.8.0/highlightjs-line-numbers.min.js"></script><link rel="stylesheet" href="https://cdn.staticfile.org/highlight.js/11.8.0/styles/github.min.css"><script src="/js/lib/highlight.js"></script><script src="/js/lib/preview.js"></script><link rel="stylesheet" href="/css/main.css"><meta name="generator" content="Hexo 6.2.0"></head><body><div id="layout"><transition name="fade"><div id="loading" v-show="loading"><div id="loading-circle"><h2>LOADING</h2><p>加载过慢请开启缓存 浏览器默认开启</p><img src="/images/loading.gif"></div></div></transition><div id="menu" :class="{ hidden: hiddenMenu, 'menu-color': menuColor}"><nav id="desktop-menu"><a class="title" href="/"><span>NIGHTTELLの小世界</span> </a><a href="/"><i class="fa-solid fa-house fa-fw"></i> <span>&ensp;Home</span> </a><a href="/about"><i class="fa-solid fa-id-card fa-fw"></i> <span>&ensp;About</span> </a><a href="/archives"><i class="fa-solid fa-box-archive fa-fw"></i> <span>&ensp;Archives</span> </a><a href="/categories"><i class="fa-solid fa-bookmark fa-fw"></i> <span>&ensp;Categories</span> </a><a href="/tags"><i class="fa-solid fa-tags fa-fw"></i> <span>&ensp;Tags</span></a></nav><nav id="mobile-menu"><div class="title" @click="showMenuItems = !showMenuItems"><i class="fa-solid fa-bars fa-fw"></i> <span>&emsp;NIGHTTELLの小世界</span></div><transition name="slide"><div class="items" v-show="showMenuItems"><a href="/"><div class="item"><div style="min-width:20px;max-width:50px;width:10%"><i class="fa-solid fa-house fa-fw"></i></div><div style="min-width:100px;max-width:150%;width:20%">Home</div></div></a><a href="/about"><div class="item"><div style="min-width:20px;max-width:50px;width:10%"><i class="fa-solid fa-id-card fa-fw"></i></div><div style="min-width:100px;max-width:150%;width:20%">About</div></div></a><a href="/archives"><div class="item"><div style="min-width:20px;max-width:50px;width:10%"><i class="fa-solid fa-box-archive fa-fw"></i></div><div style="min-width:100px;max-width:150%;width:20%">Archives</div></div></a><a href="/categories"><div class="item"><div style="min-width:20px;max-width:50px;width:10%"><i class="fa-solid fa-bookmark fa-fw"></i></div><div style="min-width:100px;max-width:150%;width:20%">Categories</div></div></a><a href="/tags"><div class="item"><div style="min-width:20px;max-width:50px;width:10%"><i class="fa-solid fa-tags fa-fw"></i></div><div style="min-width:100px;max-width:150%;width:20%">Tags</div></div></a></div></transition></nav></div><transition name="fade"><div id="menu-curtain" @click="showMenuItems = !showMenuItems" v-show="showMenuItems"></div></transition><div id="main" :class="loading ? 'into-enter-from': 'into-enter-active'"><div class="article"><div><h1>WFST加权有限状态转换机-下</h1></div><div class="info"><span class="date"><span class="icon"><i class="fa-solid fa-calendar fa-fw"></i> </span>2025/7/10 </span><span class="category"><a href="/categories/%E7%AE%97%E6%B3%95/"><span class="icon"><i class="fa-solid fa-bookmark fa-fw"></i> </span>算法 </a></span><span class="tags"><span class="icon"><i class="fa-solid fa-tags fa-fw"></i> </span><span class="tag"><a href="/tags/%E7%AE%97%E6%B3%95/" style="color:#03a9f4">算法</a> </span><span class="tag"><a href="/tags/%E5%8A%A0%E6%9D%83%E6%9C%89%E9%99%90%E7%8A%B6%E6%80%81%E8%BD%AC%E6%8D%A2%E6%9C%BA/" style="color:#00bcd4">加权有限状态转换机</a> </span><span class="tag"><a href="/tags/WFST/" style="color:#03a9f4">WFST</a></span></span></div><div class="content" v-pre><h4 id="在学习wfst搜集了一些资料加上自己的理解如果有错误欢迎评论">在学习WFST，搜集了一些资料，加上自己的理解，如果有错误欢迎评论！</h4><p>上一篇太长了，分成第二篇</p><hr><p>顺便补充一下HMM，看下面的链接：</p><h3 id="hmm的小知识"><a href="https://nighttell.github.io/2025/07/09/HMM/">HMM的小知识</a></h3><hr><p>再来看看FSA和FST的区别：</p><table><colgroup><col style="width:34%"><col style="width:31%"><col style="width:33%"></colgroup><thead><tr><th>特性</th><th>FSA(Finite-State Automaton)</th><th>FST(Finite-State Transducer)</th></tr></thead><tbody><tr><td>输入/输出</td><td>仅处理输入，判断是否接受</td><td>处理输入并生成输出</td></tr><tr><td>转移标签</td><td>仅输入符号（如 <code>a</code>）</td><td>输入输出对（如 <code>a:b</code>）</td></tr><tr><td>用途</td><td>语言识别，正则匹配</td><td>字符串转换，语音识别，机器翻译</td></tr></tbody></table><p>ps：下面这图和话均是欧阳盆栽大佬的原画，hhhh</p><p>下面这张图，介绍了集中FA的具体转换方式（腹诽一句，这个图画的差点累岔气）：</p><p><img src="https://pic1.zhimg.com/v2-14d9501fb2a1d0789307b8feacdb09b2_1440w.jpg"></p><p>几种FA之间的关系</p><p>讲完了FA相关的知识，我们可以看到，一个普通的FA可以通过加输入输出、加权，转化为WFST，而在语音识别领域，往往是由 [HCLG] 这四个小网络通过一定的“操作”组合在一起，成为了一个大的WFST网络的，也就是说WFST是网络的结构，而HCLG代表了网络的四部分“内容”：</p><p>H(声学模型)：</p><p>H是把声学观察序列变成上下文相关因子序列的WFST。这个WFST代表声学模型，它的输入是观察序列，输出是上下文相关因子序列及其概率。([HMM]）模型。</p><p>C(跨词三音子模型) ：</p><p>C 是把上下文相关的因子序列转换成上下文无关的因子序列的WFST。</p><p>L(发音词典)：</p><p>它的输入(上下文无关的)因子序列，输出是词序列。</p><p>G(语言模型)：</p><p>它是一个WFSA，它的输入是一个词序列，然后G可以判断这个词序列是否符合语法以及它的概率。(n-gram)</p><h2 id="加权有限状态转换器wfst">加权有限状态转换器(WFST)</h2><hr><p><img src="https://pic2.zhimg.com/v2-3b66205117adc7e1df3d1ad1059d925b_1440w.jpg"></p><p><img src="https://picx.zhimg.com/v2-c0fa9098a5cbc1de7a408a134ca49fb5_1440w.png"></p><p><img src="https://pica.zhimg.com/v2-07d643567059ff2e9455a8c3026bbd9e_1440w.jpg"></p><p>WFST之中，<a target="_blank" rel="noopener" href="https://zhida.zhihu.com/search?content_id=170141649&amp;content_type=Article&amp;match_order=1&amp;q=Tropical+semiring&amp;zd_token=eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJ6aGlkYV9zZXJ2ZXIiLCJleHAiOjE3NTIyMTc1ODQsInEiOiJUcm9waWNhbCBzZW1pcmluZyIsInpoaWRhX3NvdXJjZSI6ImVudGl0eSIsImNvbnRlbnRfaWQiOjE3MDE0MTY0OSwiY29udGVudF90eXBlIjoiQXJ0aWNsZSIsIm1hdGNoX29yZGVyIjoxLCJ6ZF90b2tlbiI6bnVsbH0.fcOwUZ2v_xwX-8BRQjZikfkM8Bry2WCRW1w90nyGP_0&amp;zhida_source=entity">Tropical semiring</a>是最常用的一个半环，而在一些WFST优化步骤中也会用到</p><p>Log半环。</p><p><img src="https://pic3.zhimg.com/v2-0ba39eb6cbbbbd415fcdac9017f934be_1440w.jpg"></p><h2 id="复合操作">复合操作</h2><p>复合操作的前提是，前一个WFST的输出属于后一个WFST的输入<br>（有点像向量加法哈：AC+CB=AB<br>你别说，还真挺像<br>如图下所示<br>找到a：b，a输入b输出，<br>和b：a，b输入a输出，<br>就变成了<br>a:a，a输入，a输出，然后概率相乘<br><img src="https://picx.zhimg.com/v2-740a6b847b85b1b6f4faf63301087d61_1440w.jpg"></p><p>（对于1B节点，考虑所有可能组合，0A，1B 然后2A1B，然后3A1B，对于每个节点遍历的考虑）</p><p>注意：组合可能会舍弃掉某些边。</p><p>可以动手算一下：c为AC复合得到的，注意但是原文中的这个权重计算不太对，应该是相乘。而博客的示例可能是为了说明另一种权重系统（比如Tropical半环，其中权重为负对数概率，则组合时权重相加）而设计的。但是他没有转成负对数，有点奇怪。</p><p><a href=""><img src="https://fancyerii.github.io/img/wfst/wfst-comp.png"></a><em>图：WFST复合操作的例子</em></p><h2 id="转移消除ε-removal操作"><strong>转移消除（[ε-removal]操作</strong></h2><h3 id="半环semiring框架在加权自动机wfsawfst中的应用"><strong>半环（Semiring）框架在加权自动机（WFSA/WFST）中的应用</strong></h3><ol type="1"><li><p>操作(⨂ 和 ⨁) 的定义与作用：<br>• 路径累积操作 ⨂： 定义了如何将一条路径上边的权重组合成该路径的总权重。例如，在一条路径上依次经过边权 <code>w1, w2, ..., wn</code>，该路径的总权重为 <code>w1 ⨂ w2 ⨂ ... ⨂ wn</code>。</p><p>• 路径合并操作 ⨁： 定义了如何合并具有相同输入序列（到达相同或不同状态）的多条路径的权重，得到一个代表这些路径集合的总体权重。</p><p>• 符号约定： 使用 <code>⨂</code> 表示权重累积操作，<code>⨁</code> 表示权重合并操作，是处理加权自动机的标准数学框架。</p></li><li><p>常见半环组合及其物理意义：<br>• 概率半环 (Probability Semiring)： <code>(⨁, ⨂) = (+, *)</code></p><p>◦ 意义： 权重直接表示概率 (或代价)。</p><p>◦ 应用： 总路径权重 = 边权乘积 (<code>*</code>)，相同输入序列的总权重 = 所有路径权重求和 (<code>+</code>)。 常用于需要计算所有路径概率之和的场景。</p><p>• 最大-概率半环 (Max-Probability / Viterbi Semiring)： <code>(⨁, ⨂) = (max, *)</code></p><p>◦ 意义： 权重表示概率 (或代价)。</p><p>◦ 应用： 总路径权重 = 边权乘积 (<code>*</code>)，相同输入序列的总权重 = 最大路径权重 (<code>max</code>)。 用于寻找最可能路径（Viterbi解码）。</p><p>• 热带半环 (Tropical Semiring)： <code>(⨁, ⨂) = (min, +)</code></p><p>◦ 意义： 权重表示概率的负对数 (<code>-log(prob)</code>) 或一般化的代价/距离。代价越低（<code>min</code>）对应概率越高。</p><p>◦ 应用： 总路径权重 = 边权 <em>之和</em> (<code>+</code>)，相同输入序列的总权重 = 最小路径权重 (<code>min</code>)。 用于寻找最低代价（最高概率）路径。名称由来： 其发现者系巴西（热带国家）数学家 Imre Simon。</p><p>• 对数半环 (Log Semiring)： <code>(⨁, ⨂) = (-log(e^&#123;-x&#125; + e^&#123;-y&#125;), +)</code></p><p>◦ 意义： 权重表示概率的负对数 (<code>-log(prob)</code>)。</p><p>◦ 应用： 总路径权重 = 边权 <em>之和</em> (<code>+</code>)，相同输入序列的总权重 = <code>-log(e^&#123;-w1&#125; + e^&#123;-w2&#125; + ... + e^&#123;-wn&#125;)</code>。 这是概率半环在负对数空间下的精确等价形式。 用于在负对数空间精确计算所有路径的总概率。</p><p>• 核心见解： 在语音识别中，前两种（<code>(+, *)</code> 和 <code>(max, *)</code>）通常直接作用于概率值，后两种（<code>(min, +)</code> 和 <code>(-log(e^&#123;-x&#125;+e^&#123;-y&#125;), +)</code>）作用于概率的负对数值。</p></li><li><p>Viterbi 近似 (Viterbi Approximation) 的解释：<br>• 当权重表示概率时，如果使用 <code>max</code> 作为合并操作 (<code>⨁</code>)，代替概率求和 (<code>+</code>)，这意味着我们只保留概率最大的那条路径，忽略其他路径。这就是 Viterbi 近似（或 Viterbi 解码）。</p><p>• 负对数空间下的对应： 如果权重表示概率的负对数 (<code>-log(prob)</code>)，则：</p><p>◦ 概率求和 (<code>+</code>) 的对应操作是 <code>-log(e^&#123;-x&#125; + e^&#123;-y&#125;)</code> (Log半环的 <code>⨁</code>）。</p><p>◦ 取最大值 (<code>max</code>) 的对应操作变成了取最小值 (<code>min</code>) (Tropical半环的 <code>⨁</code>)。 因为较小的负对数权重对应较大的原始概率。</p></li><li><p>WFSA/WFST 确定化 (Determinization) 的核心挑战：<br>• 与普通 NFA 确定化（子集构造法）类似：给定输入字符串，找到所有可到达的状态集合。</p><p>• 关键区别 (核心价值点)： 在 WFSA/WFST 中，相同的输入字符串可能通过多条具有不同权重的路径到达不同的状态。确定化过程不仅需要合并这些状态，还必须合并这些路径的权重。</p><p>• 合并权重的操作： 合并后的权重必须由所选的 <code>⨁</code> 操作决定！这是确定化算法的精髓和主要挑战。</p><p>◦ <em>正确表述：</em> “但是状态 0 到状态 &lt;1,2&gt; 的 weight 是由 <code>⨁</code> 操作决定的（例如在 Tropical Semiring 下是 <code>min(1, 2) = 1</code>，在 Probability Semiring 下是 <code>1 + 2 = 3</code>）。”</p><p>• “剩余权重（Remaining Weight）”/“残差（Residual）”的概念引入： 在确定化过程中需要记录额外信息以处理非确定性的权重分布。它触及了标准 WFSA 确定化算法（如 Mohri 提出的权重推送算法）的核心思想——跟踪每个状态在合并子集内的权重偏差，以便正确地组合后续路径权重。</p></li><li><p>半环的普适性：<br>• <code>⨁</code> 和 <code>⨂</code> 操作不限于列举的几种，只要它们满足半环的公理要求（结合律、分配律、存在零元和单位元等），这种代数结构（半环）就可以用来定义加权自动机的行为。这是理论框架的核心抽象。-</p></li></ol><hr><h3 id="实际计算示例"><strong>实际计算示例</strong></h3><p>场景：两条路径权重为 <code>w₁ = -log(0.3) ≈ 1.20</code>, <code>w₂ = -log(0.5) ≈ 0.69</code><br>（对应概率 <code>P₁=0.3</code>, <code>P₂=0.5</code>）。</p><p>• 概率半环：</p><p>总概率 = <code>0.3 + 0.5 = 0.8</code><br>• 对数半环：</p><p>总权重 = <code>-log(e⁻¹˙²⁰ + e⁻⁰˙⁶⁹) ≈ -log(0.3 + 0.5) = -log(0.8) ≈ 0.22</code><br>• 热带半环：</p><p>结果 = <code>min(1.20, 0.69) = 0.69</code>（仅对应 <code>max(0.3, 0.5)=0.5</code>，漏掉 <code>0.3</code>）。</p><hr><blockquote><p>ps：只有满足半环公理的系统，才能通过动态规划（如前向算法）高效计算所有路径之和。</p></blockquote><p>WFST构建过程中，ε的状态转移对整体输入输出序列没有贡献，存在一个算法(ε-消除算法)把一个ε-NFA转换成与之等价的没有ε-跳转的NFA。</p><p>前期优化过程中留下、生成或引入空弧标记，最后进行去空弧操作减少整体复杂度。</p><p><img src="https://pic1.zhimg.com/v2-93b97cac631236ddecfd4b45c0c3edc6_1440w.jpg"></p><p><img src="https://pic2.zhimg.com/v2-3348ea7c6d24f52c7066f75eb8e4fd83_1440w.jpg"></p><p><img src="https://pic2.zhimg.com/v2-5b0b930f9e641b7fc34357c79734c5a9_1440w.jpg"></p><p><img src="https://picx.zhimg.com/v2-e6c2def0ac31c99256d1d08b24a7203b_1440w.jpg"></p><p><img src="https://picx.zhimg.com/v2-d792363cfe9ebf69dafdbed97bd5ae81_1440w.jpg"></p><hr><hr><p>下图来源于知乎</p><h2 id="确定化操作determinization"><strong>确定化操作（Determinization）</strong></h2><blockquote><p>ps：跟NFA到DFA的相似，但是不相同</p></blockquote><table><colgroup><col style="width:25%"><col style="width:17%"><col style="width:57%"></colgroup><thead><tr><th>特征</th><th>NFA到DFA确定化 (标准子集构造)</th><th>WFST确定化</th></tr></thead><tbody><tr><td>核心对象</td><td>FSA (输入单轨)</td><td>WFST (输入-输出双轨 + 权重)</td></tr><tr><td>主要不确定性</td><td>输入转移状态不确定性</td><td>输入转移状态不确定性 + 输出不确定性</td></tr><tr><td>核心合并操作</td><td>合并状态集合 (Q-subset)</td><td>合并状态、计算输出LCP、管理输出残差、组合权重</td></tr><tr><td>新状态</td><td>原始状态集合 (e.g., {q0, q1})</td><td>元组集合 (e.g., { (q0, ε), (q1, "y") })</td></tr><tr><td>边标签</td><td>输入标签</td><td>输入标签 + 输出标签 (LCP) + 权重</td></tr><tr><td>权重处理</td><td>无</td><td>必须（依赖半环）</td></tr><tr><td>输出标签处理</td><td>无</td><td>必须（LCP提取与残差管理）</td></tr><tr><td>对 ε-transitions 的要求</td><td>算法本身可直接处理输入ε</td><td>通常需要输入ε-自由或先进行 ε-移除</td></tr><tr><td>功能等价目标</td><td>接受相同的输入语言</td><td>具有相同的输入-&gt;输出+权重映射关系</td></tr><tr><td>算法复杂度</td><td>相对较低 (状态空间爆炸)</td><td>显著更高 (状态复杂 + LCP/权重计算)</td></tr></tbody></table><p>虽然 WFST 的确定化借鉴了 NFA 到 DFA 的 子集构造法（幂集构造） 的基本理念来解决 <em>输入转移的不确定性</em>，但它是一个显著更复杂的过程。其核心区别和额外复杂性来源于必须同时、正确地处理输出标签的合并（通过LCP提取和残差管理）以及权重的组合与传播（根据半环语义），以维持原始WFST的输入-输出-权重映射关系。输出序列的管理，尤其是公共前缀的抽取和剩余后缀的延迟处理，是WFST确定化独有的、最核心的区别点。权重则需要依据所选代数结构（半环）进行符合语义的合并。</p><p>可以说，NFA到DFA的确定化是WFST确定化的一个特例（当权重不影响路径选择且输出标签不存在或等同于输入标签时）。但在实践中，正是因为WFST处理了权重和双轨映射，它的确定化才如此关键且算法复杂。</p><hr><p>如果从一个状态遇到一个字母会有两条及其以上的边，那么它就是非确定的</p><p>确定化的算法就是把一个非确定的WFST转换成等价的确定的WFST的算法，确定化后，网络将变为唯一输入和唯一输出。（与FSA相同）</p><blockquote><p>（这个佬画的太好了Orz，（直接偷了<br>（但是这个大佬，好像不写文章了</p></blockquote><p>在每个final state之中，输出必定被替换为ε。优点：提高计算效率</p><p><img src="https://picx.zhimg.com/v2-443df5abd76fcc065f2a2a7f7a0fea77_1440w.jpg"></p><p><img src="https://pic1.zhimg.com/v2-a4d6faed5a1a2e5057703398f9f00db6_1440w.jpg"></p><p><img src="https://pic4.zhimg.com/v2-6493940018a92625c03491fc873d4ff7_1440w.jpg"><br>ps：上图的计算流程示例：</p><hr><h3 id="公式解析">公式解析</h3><p><span class="math inline">\(W_{r} ( e_{i} )= W_{r} (e_{i}^{n})^ {-1} \otimes W(p[ e_{i} ]) \otimes W( e_{i})\)</span></p><p>在热带半环 (<code>min</code>, <code>+</code>) 语境下，符号 <code>⊗</code> 实际对应加法 (<code>+</code>)，符号 <code>⁻¹</code> 表示加法逆元（即取负值）。公式中的符号含义如下：</p><ol type="1"><li><p>变量定义：<br>• <span class="math inline">\(e_{i}\)</span>: 原始WFST中的一条转移边（待合并的边）</p><p>• <span class="math inline">\(W_{r}(e_{i})\)</span>: 计算结果 → 原始边 <span class="math inline">\(e_{i}\)</span> 的路径预估代价</p><blockquote><p>例：这个最后的结果用于下次的新状态的权重（也就是下一次的剩余权重<br>• <span class="math inline">\({W_{r}(e_{i}^{n})^{-1}}\)</span>: 当前确定化状态（<code>S</code>）权重的加法逆元</p></blockquote><p>◦ 即 <span class="math inline">\(-W_r(S)\)</span>（状态权重的相反数）</p><blockquote><p>例：在上图来说这个值是新弧的权重的相反数： 1 到 -1<br>• <span class="math inline">\(W\left(p[e_{i}]\right)\)</span>: 原始边起点的分量残差权重（新状态中存储的）</p></blockquote><blockquote><p>例：这个值是上一个权重的状态所以是0，0<br>• <span class="math inline">\(W\left(e_{i}\right)\)</span>: 原始边 <span class="math inline">\(e_{i}\)</span> 的边权重</p></blockquote><blockquote><p>例：这个值是0输入a到1的权重，0输入a到2的权重</p></blockquote></li></ol><hr><p><img src="https://pic4.zhimg.com/v2-b51a9981785ce9210882d55020b7aa99_1440w.jpg"></p><p><img src="https://pic1.zhimg.com/v2-e9ef3d10f1d0256f9951af0a53f4e7f2_1440w.jpg"></p><p><img src="https://picx.zhimg.com/v2-d7c2b6caf916226194726b22e1354edb_1440w.jpg"></p><blockquote><p>ps：上图的（0，1）因为是自环，所以是表示这个公式的自洽</p></blockquote><p><img src="https://pic2.zhimg.com/v2-0f82a5ec3632e6b1e455ae42d7de6749_1440w.jpg"></p><p><img src="https://pica.zhimg.com/v2-fda0410c0d789687f777207cba2d5f46_1440w.jpg"></p><p><img src="https://pic2.zhimg.com/v2-482995c24f8b1bd13fd74df38f0940d5_1440w.jpg"></p><p><img src="https://pic1.zhimg.com/v2-b730344032fb3e3029030994caa86a96_1440w.jpg"></p><p><img src="https://pic1.zhimg.com/v2-f1cc9afee321b008519b868fce175a80_1440w.jpg"></p><p><img src="https://picx.zhimg.com/v2-df3f6bc20392485bdc117b7d706820c1_1440w.jpg"></p><blockquote><p>当前确定化状态包含原始状态 3，且其剩余权重为 0.</p></blockquote><hr><h2 id="weight-pushing操作">weight-pushing操作</h2><blockquote><p>继续偷大佬的图</p></blockquote><p>前提：语音识别问题可以转化为搜索最小惩罚路径(minimal cost path)；</p><p>优点：在一开始消除掉“绝路”(unPomising path)能够缩短搜索时间；</p><p>原因：最小化操作的必要条件，变换前后路径上的权重相等；</p><p>做法：重新分配WFST上的权重，使得权重尽可能提前。</p><p>Weight Pushing运算的作用是把一个WFST所有路径的weight分布往初始状态push，但是不改变任何成功路径的weight。</p><p><img src="https://pica.zhimg.com/v2-494dbc6f236fd35454c4089f50f4f17a_1440w.jpg"></p><p><img src="https://pica.zhimg.com/v2-1ef11b45bc6333d6069d2c24bb948472_1440w.jpg"></p><blockquote><p>注意，上图Π2的权重计算前部分公式有问题，但是后半部分是对的</p></blockquote><p><img src="https://pica.zhimg.com/v2-9964f73fa480d6c1f8f3e65784a67312_1440w.jpg"></p><blockquote><p>上图权重编号V[i]表示由第i个节点到最后节点的权重</p></blockquote><blockquote><p>上面是准备过程，下面开始计算了</p></blockquote><p><img src="https://pic4.zhimg.com/v2-9fb25c75ac8c2bcfcaa4b974c5cfaabb_1440w.jpg"></p><blockquote><p>注意这个λ（3）的计算突然就出现了：建议直接置0，不用计算(跟半环定理温和)</p></blockquote><blockquote><p>λ(i)：状态<br>i 的前向权重（forward weight），表示从初始状态到 i 的所有路径的权重累积（在半环操作下）。</p></blockquote><blockquote><p>ρ(i)：状态 i 的后向权重（backward weight），表示从 i 到终止状态的所有路径的权重累积。<br>V[i]：在一些算法中，这是一个势函数（potential function），用于重加权。在您提供的公式中，<br>V[3] 被定义为ρ(3)，即后向权重。</p></blockquote><p><img src="https://pica.zhimg.com/v2-121cc2b5a4facc2b9f65e7dcad4e7178_1440w.jpg"></p><p><img src="https://picx.zhimg.com/v2-20a49b4705f3fbe5adba24a58a2479e7_1440w.jpg"></p><p><img src="https://pic1.zhimg.com/v2-f61934b2e834b7403289c80ca09d497c_1440w.jpg"></p><hr><h2 id="最小化操作">最小化操作</h2><blockquote><p>最后再偷一个图（感觉就直接过去了，中间也没计算啥的</p></blockquote><p>首先给一个已经确定化完毕的WFST，并且已经weight-pushed完毕得到min(push(det(T)))</p><p>对于两个状态P和Q，从这两个状态出发到达终止状态的所有路径，若这些路径上的所有字元和权重全部相同，则称P和Q等价</p><p><img src="https://pica.zhimg.com/v2-8666cd7c689b79cea186f6d4056faa32_1440w.jpg"></p><p>学习资料来源：</p><p>• <a target="_blank" rel="noopener" href="https://fancyerii.github.io/books/wfst/" class="uri">https://fancyerii.github.io/books/wfst/</a></p><p>• <a target="_blank" rel="noopener" href="https://zhuanlan.zhihu.com/p/369054845" class="uri">https://zhuanlan.zhihu.com/p/369054845</a></p><p>• deepseek</p><p>• <a target="_blank" rel="noopener" href="https://zhuanlan.zhihu.com/p/280697554" class="uri">https://zhuanlan.zhihu.com/p/280697554</a></p><p>• <a target="_blank" rel="noopener" href="https://zhuanlan.zhihu.com/p/431415117" class="uri">https://zhuanlan.zhihu.com/p/431415117</a></p></div><div id="comment"><div id="giscus-container" class="giscus"></div></div></div><footer id="footer"><div id="footer-wrap"><div>&copy; 2022 - 2025 Nighttellの小世界 <span id="footer-icon"><i class="fa-solid fa-font-awesome fa-fw"></i> </span>&commat;Nighttell</div><div>Based on the <a target="_blank" rel="noopener" href="https://hexo.io">Hexo Engine</a> &amp; <a target="_blank" rel="noopener" href="https://github.com/theme-particlex/hexo-theme-particlex">ParticleX Theme</a></div></div></footer></div><transition name="fade"><div id="preview" ref="preview" v-show="previewShow"><img id="preview-content" ref="previewContent"></div></transition></div><canvas id="fireworks" style="position:fixed;top:0;left:0;width:100vw;height:100vh;pointer-events:none;z-index:32767"></canvas><script src="https://cdn.staticfile.org/animejs/3.2.1/anime.min.js"></script><script src="/js/fireworks.min.js"></script><canvas id="background" style="position:fixed;top:0;left:0;width:100vw;height:100vh;pointer-events:none;z-index:-1"></canvas><script src="/js/background.min.js"></script><script src="/js/main.js"></script><script src="https://giscus.app/client.js" data-repo="Nighttell/comment" data-repo-id="R_kgDOKS6dPw" data-category="Announcements" data-category-id="DIC_kwDOKS6dP84CZRPV" data-mapping="pathname" data-strict="0" data-reactions-enabled="1" data-emit-metadata="0" data-input-position="bottom" data-theme="preferred_color_scheme" data-lang="zh-CN" crossorigin async></script></body></html>